<div  ng-controller="TaskCtrl">
	<div style="padding-top:10px;">
		<input type="text" ng-model="taskSearchText" style="margin-bottom:20px;" ng-keypress="enterQuery($event.keyCode)">
		<div class="pull-right">
			<label style="margin-bottom:20px;display:inline-block">一共[[totalTask]]个任务([[totalPage]]页),当前第[[nowPage]]页</label>
			<div class="btn-group" style="margin-bottom:20px;">
			  <button class="btn" ng-click="nowPage=1">First</button>
			  <button class="btn [[isDisable('pre')]] " ng-click="nowPage=nowPage-1">Pre</button>
			  <button class="btn [[isDisable('next')]] " ng-click="nowPage=nowPage+1">Next</button>
			  <button class="btn" ng-click="nowPage=totalPage">Last</button>
			</div>
			<input type="text" style="width:50px;margin-bottom:20px;" ng-model="wantPage">
			<button type="button" class="btn" style="margin-bottom:20px;" ng-click="jump()">跳转</button>
		</div>
		<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" id="task-table">
			<thead>
		        <tr>
		           <th ng-click="changeOrderBy('id')"><i class="[[getIconClass('id')]]"></i> id</th>
					<th ng-click="changeOrderBy('sumbitTime')" style="width:100px"><i class="[[getIconClass('sumbitTime')]]"></i> 提交时间</th>
					<th ng-click="changeOrderBy('taskType')"><i class="[[getIconClass('taskType')]]"></i> 任务类型</th>
					<th ng-click="changeOrderBy('service')"><i class="[[getIconClass('service')]]"></i> 服务</th>
					<th ng-click="changeOrderBy('host')"><i class="[[getIconClass('host')]]"></i> 机器</th>
					<th ng-click="changeOrderBy('role')"><i class="[[getIconClass('role')]]"></i> 角色</th>
					<th ng-click="changeOrderBy('task')"><i class="[[getIconClass('task')]]"></i> 任务名称</th>
					<th ng-click="changeOrderBy('status')"><i class="[[getIconClass('status')]]"></i> 状态</th>
					<th ng-click="changeOrderBy('result')"><i class="[[getIconClass('result')]]"></i> 结果</th>
					<th>消息</th>
					<th>操作 </th>
		        </tr>
		    </thead>
		    <tbody>
		        <tr ng-repeat="task in tasks">
		            <td>[[task.id]]</td>
		            <td>[[task.sumbitTime]]</td>
		            <td>[[task.taskType]]</td>
		            <td>[[task.service]]</td>
		            <td>[[task.host]]</td>
		            <td>[[task.role]]</td>
		            <td>[[task.task]]</td>
		            <td>[[task.status]]</td>
		            <td><i class="[[ resultIconMap[task.result]['class'] ]]" style="[[ resultIconMap[task.result]['style'] ]]" ></i> [[task.result]]</td>
		            <td><button class="btn" ng-click="showTaskDetail(task.id)">msg</button></td>
		            <td>
		            	<div class="btn-group" >
							<button class="btn drop-down-toggle" data-toggle="dropdown" ng-disabled="task.status=='init'">操作<span class="caret"></span>
							</button>
							<ul class="dropdown-menu" style="min-width:0px">
								<li ng-click="killTask(task.id)" ng-show="task.status=='running'"><a>终止</a></li>
								<li ng-click="rerunTask(task.id)" ng-show="task.status=='finish'"><a>重跑</a></li>
							</ul>
						</div>
		            </td>
		        </tr>
		    </tbody>	
		</table>
	</div>
	<div>
		<!-- 查看任务详细信息的模式对话框 -->
        <div id="taskDetailModal" class="modal hide fade" data-backdrop="static" aria-hidden="true" style="width:950px;left:auto;margin-left:0px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h3>任务[[nowTask.id]]</h3>
            </div>
            <div class="modal-body">
                <div class="input-prepend" style="width:300px">
	               <span class="add-on">id</span><input type="text" ng-model="nowTask.id" readonly>
	            </div>
	            <div class="input-prepend" style="width:300px">
	               <span class="add-on">提交时间</span><input type="text" ng-model="nowTask.sumbitTime" readonly>
	            </div>
	            <div class="input-prepend" style="width:300px">
	               <span class="add-on">任务类型</span><input type="text" ng-model="nowTask.taskType" readonly>
	            </div>
	            <div class="input-prepend" style="width:300px">
	               <span class="add-on">服务</span><input type="text" ng-model="nowTask.service" readonly>
	            </div>
	            <div class="input-prepend" style="width:300px">
	               <span class="add-on">机器</span><input type="text" ng-model="nowTask.host" readonly>
	            </div>
	            <div class="input-prepend" style="width:300px">
	               <span class="add-on">角色</span><input type="text" ng-model="nowTask.role" readonly>
	            </div>
	            <div class="input-prepend" style="width:300px">
	               <span class="add-on">任务名称</span><input type="text" ng-model="nowTask.task" readonly>
	            </div>
	            <div class="input-prepend" style="width:300px" >
	               <span class="add-on">状态</span><input type="text" ng-model="nowTask.status" readonly>
	            </div>
	            <div class="input-prepend" style="width:300px">
	               <span class="add-on">结果</span><input type="text" ng-model="nowTask.result" readonly>
	            </div>
	            <div>
	            	<label>任务消息</label>
	            	<pre style="border-style:groove">[[nowTask.msg]]</pre>
	            </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
            </div>
        </div>
	</div>
</div>